<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>pow函数有四样写法，你知道吗 | HermitSun</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="觉今是而昨非">
    <link rel="preload" href="/assets/css/0.styles.8fbd8908.css" as="style"><link rel="preload" href="/assets/js/app.45eeab25.js" as="script"><link rel="preload" href="/assets/js/2.fca48e13.js" as="script"><link rel="preload" href="/assets/js/21.0b1f777a.js" as="script"><link rel="prefetch" href="/assets/js/10.efaf4b3f.js"><link rel="prefetch" href="/assets/js/11.70aeb97b.js"><link rel="prefetch" href="/assets/js/12.fba20a78.js"><link rel="prefetch" href="/assets/js/13.ddd21741.js"><link rel="prefetch" href="/assets/js/14.92f92c52.js"><link rel="prefetch" href="/assets/js/15.b11c19d8.js"><link rel="prefetch" href="/assets/js/16.dfcb69b8.js"><link rel="prefetch" href="/assets/js/17.c2b27f90.js"><link rel="prefetch" href="/assets/js/18.480f3e91.js"><link rel="prefetch" href="/assets/js/19.b84317a9.js"><link rel="prefetch" href="/assets/js/20.d42cd0ce.js"><link rel="prefetch" href="/assets/js/22.b88113b0.js"><link rel="prefetch" href="/assets/js/23.a6daefc2.js"><link rel="prefetch" href="/assets/js/24.f179e4dd.js"><link rel="prefetch" href="/assets/js/25.e35cb8a0.js"><link rel="prefetch" href="/assets/js/26.8e282119.js"><link rel="prefetch" href="/assets/js/27.b2ea9267.js"><link rel="prefetch" href="/assets/js/28.59a5d499.js"><link rel="prefetch" href="/assets/js/29.a8010088.js"><link rel="prefetch" href="/assets/js/3.d07fa4b8.js"><link rel="prefetch" href="/assets/js/30.7b77c499.js"><link rel="prefetch" href="/assets/js/31.c7c9b480.js"><link rel="prefetch" href="/assets/js/32.c3210eec.js"><link rel="prefetch" href="/assets/js/33.05d09df9.js"><link rel="prefetch" href="/assets/js/34.2b1031fc.js"><link rel="prefetch" href="/assets/js/35.41ffcf50.js"><link rel="prefetch" href="/assets/js/36.29f2257f.js"><link rel="prefetch" href="/assets/js/37.c9e2dc67.js"><link rel="prefetch" href="/assets/js/38.1ea8449b.js"><link rel="prefetch" href="/assets/js/39.0387049c.js"><link rel="prefetch" href="/assets/js/4.5431299d.js"><link rel="prefetch" href="/assets/js/5.ea32bc0a.js"><link rel="prefetch" href="/assets/js/6.1b79984f.js"><link rel="prefetch" href="/assets/js/7.61a7307f.js"><link rel="prefetch" href="/assets/js/8.6e98c852.js"><link rel="prefetch" href="/assets/js/9.9ced1618.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8fbd8908.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">HermitSun</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blogs/" class="nav-link router-link-active">
  Blogs
</a></div><div class="nav-item"><a href="/notes/" class="nav-link">
  Notes
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Contact" class="dropdown-title"><span class="title">Contact</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/HermitSun" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/HermitSun" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.yuque.com/yunwuxin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  语雀
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://leetcode-cn.com/u/hermitsun/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LeetCode
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blogs/" class="nav-link router-link-active">
  Blogs
</a></div><div class="nav-item"><a href="/notes/" class="nav-link">
  Notes
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Contact" class="dropdown-title"><span class="title">Contact</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/HermitSun" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://blog.csdn.net/HermitSun" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://www.yuque.com/yunwuxin" target="_blank" rel="noopener noreferrer" class="nav-link external">
  语雀
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://leetcode-cn.com/u/hermitsun/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  LeetCode
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/blogs/2019-08/" class="sidebar-heading clickable"><span>2019-08</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/blogs/2019-12/" class="sidebar-heading clickable"><span>2019-12</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/blogs/2020-02/" class="sidebar-heading clickable"><span>2020-02</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/blogs/2020-04/" class="sidebar-heading clickable"><span>2020-04</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/blogs/2020-05/" class="sidebar-heading clickable router-link-active open"><span>2020-05</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/blogs/2020-05/ESLint + TypeScript配置全局变量.html" class="sidebar-link">ESLint + TypeScript配置全局变量</a></li><li><a href="/blogs/2020-05/pow函数有四样写法，你知道吗.html" class="active sidebar-link">pow函数有四样写法，你知道吗</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blogs/2020-05/pow函数有四样写法，你知道吗.html#附录" class="sidebar-link">附录</a></li></ul></li><li><a href="/blogs/2020-05/Ubuntu 18.04升级systemctl（systemd）到v245.html" class="sidebar-link">Ubuntu 18.04升级systemctl（systemd）到v245</a></li><li><a href="/blogs/2020-05/Windows 10环境下V8引擎的编译方法.html" class="sidebar-link">Windows 10环境下V8引擎的编译方法</a></li><li><a href="/blogs/2020-05/前端可能用到的工具的代理设置方法.html" class="sidebar-link">前端可能用到的工具的代理设置方法</a></li><li><a href="/blogs/2020-05/在nuxt中使用keep-alive的两种可能方案.html" class="sidebar-link">在nuxt中使用keep-alive的两种可能方案</a></li><li><a href="/blogs/2020-05/在Vue项目中导入外部字体的注意点.html" class="sidebar-link">在Vue项目中导入外部字体的注意点</a></li><li><a href="/blogs/2020-05/精读ECMAScript规范：完成记录.html" class="sidebar-link">精读ECMAScript规范：完成记录（Completion Record）</a></li><li><a href="/blogs/2020-05/精读ECMAScript规范：截断.html" class="sidebar-link">精读ECMAScript规范：截断</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/blogs/2020-06/" class="sidebar-heading clickable"><span>2020-06</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/notes/需求与商业模式创新/" class="sidebar-heading clickable"><span>需求与商业模式创新</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="pow函数有四样写法，你知道吗"><a href="#pow函数有四样写法，你知道吗" class="header-anchor">#</a> pow函数有四样写法，你知道吗</h1> <p>求次幂是个老生常谈的话题了，在任何一门语言里都是最基础的部分。</p> <p>首先，最容易想到的是暴力法，也就是连续乘上n个x；但是这个的性能显然很差，我们一般不会考虑这么写。而且，为什么不用内置函数呢？调内置函数没什么难度，随便举个例子吧：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">myPow</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>确实，这个没什么难度，并且内置函数一般得到了充分的优化，性能也是很有保障的。但是，内置函数一定就快吗？还能进一步优化吗？还有没有别的方法？这些问题是值得思考的。</p> <p>这是利用数学性质来进行计算的，基于一个很简单的思路，$x^n=2^{nlog_2x}$：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">myPow</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> tmp <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">exp</span><span class="token punctuation">(</span>n <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> n <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> tmp <span class="token operator">*=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> tmp<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>而这个用的是快速幂乘法，需要注意的是，要用<code>Math.trunc</code>而不是<code>Math.floor</code>，因为<code>Math.floor</code>是向下取整，在面对负数的时候也会向下取整，导致无限递归；而<code>Math.trunc</code>则是截断，相当于向0取整：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">pow</span><span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>n <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> tmp <span class="token operator">=</span> <span class="token function">pow</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> Math<span class="token punctuation">.</span><span class="token function">trunc</span><span class="token punctuation">(</span>n <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> n <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> tmp <span class="token operator">*</span> tmp <span class="token operator">:</span> tmp <span class="token operator">*</span> tmp <span class="token operator">*</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> <span class="token function-variable function">myPow</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> n</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> n <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token function">pow</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token operator">/</span> <span class="token function">pow</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>我们已经看到了其他的写法，按理来说，到这里已经可以结束了，但是我发现，在执行次数很少的情况下，手写的代码反而可能比原生的快，这就很奇怪了。所以我打算看看V8的源码，能不能看出点东西来：</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>CodeStubAssembler<span class="token operator">::</span>Node<span class="token operator">*</span> MathBuiltinsAssembler<span class="token operator">::</span><span class="token function">MathPow</span><span class="token punctuation">(</span>Node<span class="token operator">*</span> context<span class="token punctuation">,</span>
                                                        Node<span class="token operator">*</span> base<span class="token punctuation">,</span>
                                                        Node<span class="token operator">*</span> exponent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Node<span class="token operator">*</span> base_value <span class="token operator">=</span> <span class="token function">TruncateTaggedToFloat64</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> base<span class="token punctuation">)</span><span class="token punctuation">;</span>
  Node<span class="token operator">*</span> exponent_value <span class="token operator">=</span> <span class="token function">TruncateTaggedToFloat64</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> exponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
  Node<span class="token operator">*</span> value <span class="token operator">=</span> <span class="token function">Float64Pow</span><span class="token punctuation">(</span>base_value<span class="token punctuation">,</span> exponent_value<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">ChangeFloat64ToTagged</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
Node<span class="token operator">*</span> <span class="token function">Float64Pow</span><span class="token punctuation">(</span>Node<span class="token operator">*</span> a<span class="token punctuation">,</span> Node<span class="token operator">*</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">AddNode</span><span class="token punctuation">(</span><span class="token function">machine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">Float64Pow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

Node<span class="token operator">*</span> <span class="token function">Float64Exp</span><span class="token punctuation">(</span>Node<span class="token operator">*</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">AddNode</span><span class="token punctuation">(</span><span class="token function">machine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">Float64Exp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
Node<span class="token operator">*</span> <span class="token function">Float64Log</span><span class="token punctuation">(</span>Node<span class="token operator">*</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token function">AddNode</span><span class="token punctuation">(</span><span class="token function">machine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token function">Float64Log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
</code></pre></div><p>得，话都说到这份上了，用的是硬件自带的运算，咱也没辙。所以只能进一步深入，看看能不能从汇编层面看出点东西来，用d8编译一下，看看输出的结果。</p> <p>内容很长，放到最后面了。简单说一下结论：在执行次数很少的情况下（我这里测试大概是10000次以下），原生代码可能不会成为所谓的“热点”，也就是不会被V8编译成汇编指令；而手写的代码会被编译成汇编指令。所以，在这个情况下，是有可能存在手写比原生快的情况的；而随着执行次数的增加，原生代码也会变成汇编指令，并且条数更少，自然也就更快了。</p> <h2 id="附录"><a href="#附录" class="header-anchor">#</a> 附录</h2> <h3 id="原生"><a href="#原生" class="header-anchor">#</a> 原生</h3> <div class="language-nasm extra-class"><pre class="language-nasm"><code>Instructions (size <span class="token operator">=</span> <span class="token number">460</span>)
00000061000C2E60     <span class="token number">0</span>  488d1df9ffffff REX.W leaq <span class="token register variable">rbx</span>,<span class="token operator">[</span>rip<span class="token operator">+</span><span class="token number">0xfffffff9</span><span class="token operator">]</span>
00000061000C2E67     <span class="token number">7</span>  483bd9         REX.W cmpq <span class="token register variable">rbx</span>,<span class="token register variable">rcx</span>
00000061000C2E6A     a  <span class="token number">7418</span>           jz 00000061000C2E84  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x24</span><span class="token operator">&gt;</span>
00000061000C2E6C     c  48ba6800000000000000 REX.W movq <span class="token register variable">rdx</span>,<span class="token number">0000000000000068</span>
00000061000C2E76    <span class="token number">16</span>  49bae0c0d5cdfb7f0000 REX.W movq <span class="token register variable">r10</span>,00007FFBCDD5C0E0  (Abort)    <span class="token comment">;; off heap target</span>
00000061000C2E80    <span class="token number">20</span>  41ffd2         call <span class="token register variable">r10</span>
00000061000C2E83    <span class="token number">23</span>  cc             int3l
00000061000C2E84    <span class="token number">24</span>  8b59d0         movl <span class="token register variable">rbx</span>,<span class="token operator">[</span><span class="token register variable">rcx</span><span class="token operator">-</span><span class="token number">0x30</span><span class="token operator">]</span>
00000061000C2E87    <span class="token number">27</span>  4903dd         REX.W addq <span class="token register variable">rbx</span>,<span class="token register variable">r13</span>
00000061000C2E8A    2a  f6430701       testb <span class="token operator">[</span><span class="token register variable">rbx</span><span class="token operator">+</span><span class="token number">0x7</span><span class="token operator">]</span>,<span class="token number">0x1</span>
00000061000C2E8E    2e  <span class="token number">740d</span>           jz 00000061000C2E9D  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x3d</span><span class="token operator">&gt;</span>
00000061000C2E90    <span class="token number">30</span>  49baa0f9cacdfb7f0000 REX.W movq <span class="token register variable">r10</span>,00007FFBCDCAF9A0  (CompileLazyDeoptimizedCode)    <span class="token comment">;; off heap target</span>
00000061000C2E9A    3a  41ffe2         jmp <span class="token register variable">r10</span>
00000061000C2E9D    <span class="token number">3d</span>  <span class="token number">55</span>             push <span class="token register variable">rbp</span>
00000061000C2E9E    3e  <span class="token number">4889e5</span>         REX.W movq <span class="token register variable">rbp</span>,<span class="token register variable">rsp</span>
00000061000C2EA1    <span class="token number">41</span>  <span class="token number">56</span>             push <span class="token register variable">rsi</span>
00000061000C2EA2    <span class="token number">42</span>  <span class="token number">57</span>             push <span class="token register variable">rdi</span>
00000061000C2EA3    <span class="token number">43</span>  48ba4200000000000000 REX.W movq <span class="token register variable">rdx</span>,<span class="token number">0000000000000042</span>
00000061000C2EAD    <span class="token number">4d</span>  4c8b15c4ffffff REX.W movq <span class="token register variable">r10</span>,<span class="token operator">[</span>rip<span class="token operator">+</span><span class="token number">0xffffffc4</span><span class="token operator">]</span>
00000061000C2EB4    <span class="token number">54</span>  41ffd2         call <span class="token register variable">r10</span>
00000061000C2EB7    <span class="token number">57</span>  cc             int3l
00000061000C2EB8    <span class="token number">58</span>  4883ec10       REX.W subq <span class="token register variable">rsp</span>,<span class="token number">0x10</span>
00000061000C2EBC    5c  488975b0       REX.W movq <span class="token operator">[</span><span class="token register variable">rbp</span><span class="token operator">-</span><span class="token number">0x50</span><span class="token operator">]</span>,<span class="token register variable">rsi</span>
00000061000C2EC0    <span class="token number">60</span>  488b55d0       REX.W movq <span class="token register variable">rdx</span>,<span class="token operator">[</span><span class="token register variable">rbp</span><span class="token operator">-</span><span class="token number">0x30</span><span class="token operator">]</span>
00000061000C2EC4    <span class="token number">64</span>  f6c201         testb <span class="token register variable">rdx</span>,<span class="token number">0x1</span>
00000061000C2EC7    <span class="token number">67</span>  0f8516010000   jnz 00000061000C2FE3  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x183</span><span class="token operator">&gt;</span>
00000061000C2ECD    <span class="token number">6d</span>  81fa002d3101   cmpl <span class="token register variable">rdx</span>,<span class="token number">0x1312d00</span>
00000061000C2ED3    <span class="token number">73</span>  0f8c0b000000   jl 00000061000C2EE4  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x84</span><span class="token operator">&gt;</span>
00000061000C2ED9    <span class="token number">79</span>  488b45d8       REX.W movq <span class="token register variable">rax</span>,<span class="token operator">[</span><span class="token register variable">rbp</span><span class="token operator">-</span><span class="token number">0x28</span><span class="token operator">]</span>
00000061000C2EDD    <span class="token number">7d</span>  488be5         REX.W movq <span class="token register variable">rsp</span>,<span class="token register variable">rbp</span>
00000061000C2EE0    <span class="token number">80</span>  <span class="token number">5d</span>             pop <span class="token register variable">rbp</span>
00000061000C2EE1    <span class="token number">81</span>  c20800         ret <span class="token number">0x8</span>
00000061000C2EE4    <span class="token number">84</span>  48b9b93a240861000000 REX.W movq <span class="token register variable">rcx</span>,0000006108243AB9    <span class="token comment">;; object: 0x006108243ab9 &lt;Object map = 0000006108280A09&gt;</span>
00000061000C2EEE    8e  8b4903         movl <span class="token register variable">rcx</span>,<span class="token operator">[</span><span class="token register variable">rcx</span><span class="token operator">+</span><span class="token number">0x3</span><span class="token operator">]</span>
00000061000C2EF1    <span class="token number">91</span>  4903cd         REX.W addq <span class="token register variable">rcx</span>,<span class="token register variable">r13</span>
00000061000C2EF4    <span class="token number">94</span>  8b495b         movl <span class="token register variable">rcx</span>,<span class="token operator">[</span><span class="token register variable">rcx</span><span class="token operator">+</span><span class="token number">0x5b</span><span class="token operator">]</span>
00000061000C2EF7    <span class="token number">97</span>  49ba0000000001000000 REX.W movq <span class="token register variable">r10</span>,<span class="token number">0000000100000000</span>
00000061000C2F01    a1  4c3bd1         REX.W cmpq <span class="token register variable">r10</span>,<span class="token register variable">rcx</span>
00000061000C2F04    a4  <span class="token number">7715</span>           ja 00000061000C2F1B  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0xbb</span><span class="token operator">&gt;</span>
00000061000C2F06    a6  48ba0200000000000000 REX.W movq <span class="token register variable">rdx</span>,<span class="token number">0000000000000002</span>
00000061000C2F10    b0  4c8b1561ffffff REX.W movq <span class="token register variable">r10</span>,<span class="token operator">[</span>rip<span class="token operator">+</span><span class="token number">0xffffff61</span><span class="token operator">]</span>
00000061000C2F17    b7  41ffd2         call <span class="token register variable">r10</span>
00000061000C2F1A    ba  cc             int3l
00000061000C2F1B    bb  bff13f2408     movl <span class="token register variable">rdi</span>,0000000008243FF1    <span class="token comment">;; (compressed) object: 0x006108243ff1 &lt;JSFunction pow (sfi = 00000061081C7729)&gt;</span>
00000061000C2F20    c0  3bf9           cmpl <span class="token register variable">rdi</span>,<span class="token register variable">rcx</span>
00000061000C2F22    c2  0f85c7000000   jnz 00000061000C2FEF  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x18f</span><span class="token operator">&gt;</span>
00000061000C2F28    c8  488bca         REX.W movq <span class="token register variable">rcx</span>,<span class="token register variable">rdx</span>
00000061000C2F2B    cb  d1f9           sarl <span class="token register variable">rcx</span>, <span class="token number">1</span>
00000061000C2F2D    cd  83c101         addl <span class="token register variable">rcx</span>,<span class="token number">0x1</span>
00000061000C2F30    d0  0f80c5000000   jo 00000061000C2FFB  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x19b</span><span class="token operator">&gt;</span>
00000061000C2F36    d6  493b6560       REX.W cmpq <span class="token register variable">rsp</span>,<span class="token operator">[</span><span class="token register variable">r13</span><span class="token operator">+</span><span class="token number">0x60</span><span class="token operator">]</span> (<span class="token keyword">external value (StackGuard::address_of_jslimit()))</span>
00000061000C2F3A    da  0f8713000000   ja 00000061000C2F53  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0xf3</span><span class="token operator">&gt;</span>
00000061000C2F40    e0  e940000000     jmp 00000061000C2F85  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x125</span><span class="token operator">&gt;</span>
00000061000C2F45    e5  660f1f840000000000 nop
00000061000C2F4E    ee  <span class="token number">6690</span>           nop
00000061000C2F50    f0  488bca         REX.W movq <span class="token register variable">rcx</span>,<span class="token register variable">rdx</span>
00000061000C2F53    f3  81f980969800   cmpl <span class="token register variable">rcx</span>,<span class="token number">0x989680</span>
00000061000C2F59    f9  0f8d17000000   jge 00000061000C2F76  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x116</span><span class="token operator">&gt;</span>
00000061000C2F5F    ff  488bd1         REX.W movq <span class="token register variable">rdx</span>,<span class="token register variable">rcx</span>
00000061000C2F62   <span class="token number">102</span>  83c201         addl <span class="token register variable">rdx</span>,<span class="token number">0x1</span>
00000061000C2F65   <span class="token number">105</span>  0f809c000000   jo 00000061000C3007  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x1a7</span><span class="token operator">&gt;</span>
00000061000C2F6B   <span class="token number">10b</span>  493b6560       REX.W cmpq <span class="token register variable">rsp</span>,<span class="token operator">[</span><span class="token register variable">r13</span><span class="token operator">+</span><span class="token number">0x60</span><span class="token operator">]</span> (<span class="token keyword">external value (StackGuard::address_of_jslimit()))</span>
00000061000C2F6F   10f  77df           ja 00000061000C2F50  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0xf0</span><span class="token operator">&gt;</span>
00000061000C2F71   <span class="token number">111</span>  e942000000     jmp 00000061000C2FB8  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x158</span><span class="token operator">&gt;</span>
00000061000C2F76   <span class="token number">116</span>  48b80008000000000000 REX.W movq <span class="token register variable">rax</span>,<span class="token number">0000000000000800</span>
00000061000C2F80   <span class="token number">120</span>  e958ffffff     jmp 00000061000C2EDD  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x7d</span><span class="token operator">&gt;</span>
00000061000C2F85   <span class="token number">125</span>  48894da8       REX.W movq <span class="token operator">[</span><span class="token register variable">rbp</span><span class="token operator">-</span><span class="token number">0x58</span><span class="token operator">]</span>,<span class="token register variable">rcx</span>
00000061000C2F89   <span class="token number">129</span>  33c0           xorl <span class="token register variable">rax</span>,<span class="token register variable">rax</span>
00000061000C2F8B   12b  48bea10d240861000000 REX.W movq <span class="token register variable">rsi</span>,0000006108240DA1    <span class="token comment">;; object: 0x006108240da1 &lt;NativeContext[247]&gt;</span>
00000061000C2F95   <span class="token number">135</span>  48bbd0ec24cffb7f0000 REX.W movq <span class="token register variable">rbx</span>,00007FFBCF24ECD0    <span class="token comment">;; external reference (Runtime::StackGuard)</span>
00000061000C2F9F   13f  488bd0         REX.W movq <span class="token register variable">rdx</span>,<span class="token register variable">rax</span>
00000061000C2FA2   <span class="token number">142</span>  488bfe         REX.W movq <span class="token register variable">rdi</span>,<span class="token register variable">rsi</span>
00000061000C2FA5   <span class="token number">145</span>  49ba00a8edcdfb7f0000 REX.W movq <span class="token register variable">r10</span>,00007FFBCDEDA800  (CEntry_Return1_DontSaveFPRegs_ArgvOnStack_NoBuiltinExit)    <span class="token comment">;; off heap target</span>
00000061000C2FAF   14f  41ffd2         call <span class="token register variable">r10</span>
00000061000C2FB2   <span class="token number">152</span>  488b4da8       REX.W movq <span class="token register variable">rcx</span>,<span class="token operator">[</span><span class="token register variable">rbp</span><span class="token operator">-</span><span class="token number">0x58</span><span class="token operator">]</span>
00000061000C2FB6   <span class="token number">156</span>  eb9b           jmp 00000061000C2F53  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0xf3</span><span class="token operator">&gt;</span>
00000061000C2FB8   <span class="token number">158</span>  488955a8       REX.W movq <span class="token operator">[</span><span class="token register variable">rbp</span><span class="token operator">-</span><span class="token number">0x58</span><span class="token operator">]</span>,<span class="token register variable">rdx</span>
00000061000C2FBC   15c  488b1dd4ffffff REX.W movq <span class="token register variable">rbx</span>,<span class="token operator">[</span>rip<span class="token operator">+</span><span class="token number">0xffffffd4</span><span class="token operator">]</span>
00000061000C2FC3   <span class="token number">163</span>  33c0           xorl <span class="token register variable">rax</span>,<span class="token register variable">rax</span>
00000061000C2FC5   <span class="token number">165</span>  48bea10d240861000000 REX.W movq <span class="token register variable">rsi</span>,0000006108240DA1    <span class="token comment">;; object: 0x006108240da1 &lt;NativeContext[247]&gt;</span>
00000061000C2FCF   16f  4c8b15d1ffffff REX.W movq <span class="token register variable">r10</span>,<span class="token operator">[</span>rip<span class="token operator">+</span><span class="token number">0xffffffd1</span><span class="token operator">]</span>
00000061000C2FD6   <span class="token number">176</span>  41ffd2         call <span class="token register variable">r10</span>
00000061000C2FD9   <span class="token number">179</span>  488b55a8       REX.W movq <span class="token register variable">rdx</span>,<span class="token operator">[</span><span class="token register variable">rbp</span><span class="token operator">-</span><span class="token number">0x58</span><span class="token operator">]</span>
00000061000C2FDD   <span class="token number">17d</span>  e96effffff     jmp 00000061000C2F50  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0xf0</span><span class="token operator">&gt;</span>
00000061000C2FE2   <span class="token number">182</span>  <span class="token number">90</span>             nop
00000061000C2FE3   <span class="token number">183</span>  49c7c500000000 REX.W movq <span class="token register variable">r13</span>,<span class="token number">0x0</span>
00000061000C2FEA   18a  e851f00300     call <span class="token number">0000006100102040</span>    <span class="token comment">;; eager deoptimization bailout</span>
00000061000C2FEF   18f  49c7c501000000 REX.W movq <span class="token register variable">r13</span>,<span class="token number">0x1</span>
00000061000C2FF6   <span class="token number">196</span>  e845f00300     call <span class="token number">0000006100102040</span>    <span class="token comment">;; eager deoptimization bailout</span>
00000061000C2FFB   19b  49c7c502000000 REX.W movq <span class="token register variable">r13</span>,<span class="token number">0x2</span>
00000061000C3002   1a2  e839f00300     call <span class="token number">0000006100102040</span>    <span class="token comment">;; eager deoptimization bailout</span>
00000061000C3007   1a7  49c7c503000000 REX.W movq <span class="token register variable">r13</span>,<span class="token number">0x3</span>
00000061000C300E   1ae  e82df00300     call <span class="token number">0000006100102040</span>    <span class="token comment">;; eager deoptimization bailout</span>
00000061000C3013   1b3  49c7c504000000 REX.W movq <span class="token register variable">r13</span>,<span class="token number">0x4</span>
00000061000C301A   1ba  e821f00700     call <span class="token number">0000006100142040</span>    <span class="token comment">;; lazy deoptimization bailout</span>
00000061000C301F   1bf  49c7c505000000 REX.W movq <span class="token register variable">r13</span>,<span class="token number">0x5</span>
00000061000C3026   1c6  e815f00700     call <span class="token number">0000006100142040</span>    <span class="token comment">;; lazy deoptimization bailout</span>
00000061000C302B   1cb  <span class="token number">90</span>             nop
</code></pre></div><h3 id="手写"><a href="#手写" class="header-anchor">#</a> 手写</h3> <div class="language-nasm extra-class"><pre class="language-nasm"><code>Instructions (size <span class="token operator">=</span> <span class="token number">580</span>)
0000028E000C2F20     <span class="token number">0</span>  488d1df9ffffff REX.W leaq <span class="token register variable">rbx</span>,<span class="token operator">[</span>rip<span class="token operator">+</span><span class="token number">0xfffffff9</span><span class="token operator">]</span>
0000028E000C2F27     <span class="token number">7</span>  483bd9         REX.W cmpq <span class="token register variable">rbx</span>,<span class="token register variable">rcx</span>
0000028E000C2F2A     a  <span class="token number">7418</span>           jz 0000028E000C2F44  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x24</span><span class="token operator">&gt;</span>
0000028E000C2F2C     c  48ba6800000000000000 REX.W movq <span class="token register variable">rdx</span>,<span class="token number">0000000000000068</span>
0000028E000C2F36    <span class="token number">16</span>  49bae0c0d5cdfb7f0000 REX.W movq <span class="token register variable">r10</span>,00007FFBCDD5C0E0  (Abort)    <span class="token comment">;; off heap target</span>
0000028E000C2F40    <span class="token number">20</span>  41ffd2         call <span class="token register variable">r10</span>
0000028E000C2F43    <span class="token number">23</span>  cc             int3l
0000028E000C2F44    <span class="token number">24</span>  8b59d0         movl <span class="token register variable">rbx</span>,<span class="token operator">[</span><span class="token register variable">rcx</span><span class="token operator">-</span><span class="token number">0x30</span><span class="token operator">]</span>
0000028E000C2F47    <span class="token number">27</span>  4903dd         REX.W addq <span class="token register variable">rbx</span>,<span class="token register variable">r13</span>
0000028E000C2F4A    2a  f6430701       testb <span class="token operator">[</span><span class="token register variable">rbx</span><span class="token operator">+</span><span class="token number">0x7</span><span class="token operator">]</span>,<span class="token number">0x1</span>
0000028E000C2F4E    2e  <span class="token number">740d</span>           jz 0000028E000C2F5D  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x3d</span><span class="token operator">&gt;</span>
0000028E000C2F50    <span class="token number">30</span>  49baa0f9cacdfb7f0000 REX.W movq <span class="token register variable">r10</span>,00007FFBCDCAF9A0  (CompileLazyDeoptimizedCode)    <span class="token comment">;; off heap target</span>
0000028E000C2F5A    3a  41ffe2         jmp <span class="token register variable">r10</span>
0000028E000C2F5D    <span class="token number">3d</span>  <span class="token number">55</span>             push <span class="token register variable">rbp</span>
0000028E000C2F5E    3e  <span class="token number">4889e5</span>         REX.W movq <span class="token register variable">rbp</span>,<span class="token register variable">rsp</span>
0000028E000C2F61    <span class="token number">41</span>  <span class="token number">56</span>             push <span class="token register variable">rsi</span>
0000028E000C2F62    <span class="token number">42</span>  <span class="token number">57</span>             push <span class="token register variable">rdi</span>
0000028E000C2F63    <span class="token number">43</span>  48ba4200000000000000 REX.W movq <span class="token register variable">rdx</span>,<span class="token number">0000000000000042</span>
0000028E000C2F6D    <span class="token number">4d</span>  4c8b15c4ffffff REX.W movq <span class="token register variable">r10</span>,<span class="token operator">[</span>rip<span class="token operator">+</span><span class="token number">0xffffffc4</span><span class="token operator">]</span>
0000028E000C2F74    <span class="token number">54</span>  41ffd2         call <span class="token register variable">r10</span>
0000028E000C2F77    <span class="token number">57</span>  cc             int3l
0000028E000C2F78    <span class="token number">58</span>  4883ec10       REX.W subq <span class="token register variable">rsp</span>,<span class="token number">0x10</span>
0000028E000C2F7C    5c  488975b0       REX.W movq <span class="token operator">[</span><span class="token register variable">rbp</span><span class="token operator">-</span><span class="token number">0x50</span><span class="token operator">]</span>,<span class="token register variable">rsi</span>
0000028E000C2F80    <span class="token number">60</span>  488b55d0       REX.W movq <span class="token register variable">rdx</span>,<span class="token operator">[</span><span class="token register variable">rbp</span><span class="token operator">-</span><span class="token number">0x30</span><span class="token operator">]</span>
0000028E000C2F84    <span class="token number">64</span>  f6c201         testb <span class="token register variable">rdx</span>,<span class="token number">0x1</span>
0000028E000C2F87    <span class="token number">67</span>  0f8576010000   jnz 0000028E000C3103  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x1e3</span><span class="token operator">&gt;</span>
0000028E000C2F8D    <span class="token number">6d</span>  81fa002d3101   cmpl <span class="token register variable">rdx</span>,<span class="token number">0x1312d00</span>
0000028E000C2F93    <span class="token number">73</span>  0f8c0b000000   jl 0000028E000C2FA4  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x84</span><span class="token operator">&gt;</span>
0000028E000C2F99    <span class="token number">79</span>  488b45d8       REX.W movq <span class="token register variable">rax</span>,<span class="token operator">[</span><span class="token register variable">rbp</span><span class="token operator">-</span><span class="token number">0x28</span><span class="token operator">]</span>
0000028E000C2F9D    <span class="token number">7d</span>  488be5         REX.W movq <span class="token register variable">rsp</span>,<span class="token register variable">rbp</span>
0000028E000C2FA0    <span class="token number">80</span>  <span class="token number">5d</span>             pop <span class="token register variable">rbp</span>
0000028E000C2FA1    <span class="token number">81</span>  c20800         ret <span class="token number">0x8</span>
0000028E000C2FA4    <span class="token number">84</span>  48b9b93a24088e020000 REX.W movq <span class="token register variable">rcx</span>,0000028E08243AB9    <span class="token comment">;; object: 0x028e08243ab9 &lt;Object map = 0000028E08280A09&gt;</span>
0000028E000C2FAE    8e  8b7903         movl <span class="token register variable">rdi</span>,<span class="token operator">[</span><span class="token register variable">rcx</span><span class="token operator">+</span><span class="token number">0x3</span><span class="token operator">]</span>
0000028E000C2FB1    <span class="token number">91</span>  4903fd         REX.W addq <span class="token register variable">rdi</span>,<span class="token register variable">r13</span>
0000028E000C2FB4    <span class="token number">94</span>  448b472f       movl <span class="token register variable">r8</span>,<span class="token operator">[</span><span class="token register variable">rdi</span><span class="token operator">+</span><span class="token number">0x2f</span><span class="token operator">]</span>
0000028E000C2FB8    <span class="token number">98</span>  49ba0000000001000000 REX.W movq <span class="token register variable">r10</span>,<span class="token number">0000000100000000</span>
0000028E000C2FC2    a2  4d3bd0         REX.W cmpq <span class="token register variable">r10</span>,<span class="token register variable">r8</span>
0000028E000C2FC5    a5  <span class="token number">7715</span>           ja 0000028E000C2FDC  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0xbc</span><span class="token operator">&gt;</span>
0000028E000C2FC7    a7  48ba0200000000000000 REX.W movq <span class="token register variable">rdx</span>,<span class="token number">0000000000000002</span>
0000028E000C2FD1    b1  4c8b1560ffffff REX.W movq <span class="token register variable">r10</span>,<span class="token operator">[</span>rip<span class="token operator">+</span><span class="token number">0xffffff60</span><span class="token operator">]</span>
0000028E000C2FD8    b8  41ffd2         call <span class="token register variable">r10</span>
0000028E000C2FDB    bb  cc             int3l
0000028E000C2FDC    bc  8b7f43         movl <span class="token register variable">rdi</span>,<span class="token operator">[</span><span class="token register variable">rdi</span><span class="token operator">+</span><span class="token number">0x43</span><span class="token operator">]</span>
0000028E000C2FDF    bf  4c8b15d4ffffff REX.W movq <span class="token register variable">r10</span>,<span class="token operator">[</span>rip<span class="token operator">+</span><span class="token number">0xffffffd4</span><span class="token operator">]</span>
0000028E000C2FE6    c6  4c3bd7         REX.W cmpq <span class="token register variable">r10</span>,<span class="token register variable">rdi</span>
0000028E000C2FE9    c9  <span class="token number">7712</span>           ja 0000028E000C2FFD  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0xdd</span><span class="token operator">&gt;</span>
0000028E000C2FEB    cb  488b15d7ffffff REX.W movq <span class="token register variable">rdx</span>,<span class="token operator">[</span>rip<span class="token operator">+</span><span class="token number">0xffffffd7</span><span class="token operator">]</span>
0000028E000C2FF2    d2  4c8b153fffffff REX.W movq <span class="token register variable">r10</span>,<span class="token operator">[</span>rip<span class="token operator">+</span><span class="token number">0xffffff3f</span><span class="token operator">]</span>
0000028E000C2FF9    d9  41ffd2         call <span class="token register variable">r10</span>
0000028E000C2FFC    dc  cc             int3l
0000028E000C2FFD    dd  8b490b         movl <span class="token register variable">rcx</span>,<span class="token operator">[</span><span class="token register variable">rcx</span><span class="token operator">+</span><span class="token number">0xb</span><span class="token operator">]</span>
0000028E000C3000    e0  4c8b15b3ffffff REX.W movq <span class="token register variable">r10</span>,<span class="token operator">[</span>rip<span class="token operator">+</span><span class="token number">0xffffffb3</span><span class="token operator">]</span>
0000028E000C3007    e7  4c3bd1         REX.W cmpq <span class="token register variable">r10</span>,<span class="token register variable">rcx</span>
0000028E000C300A    ea  <span class="token number">7712</span>           ja 0000028E000C301E  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0xfe</span><span class="token operator">&gt;</span>
0000028E000C300C    ec  488b15b6ffffff REX.W movq <span class="token register variable">rdx</span>,<span class="token operator">[</span>rip<span class="token operator">+</span><span class="token number">0xffffffb6</span><span class="token operator">]</span>
0000028E000C3013    f3  4c8b151effffff REX.W movq <span class="token register variable">r10</span>,<span class="token operator">[</span>rip<span class="token operator">+</span><span class="token number">0xffffff1e</span><span class="token operator">]</span>
0000028E000C301A    fa  41ffd2         call <span class="token register variable">r10</span>
0000028E000C301D    fd  cc             int3l
0000028E000C301E    fe  41b909412408   movl <span class="token register variable">r9</span>,<span class="token number">0000000008244109</span>    <span class="token comment">;; (compressed) object: 0x028e08244109 &lt;JSFunction abs (sfi = 0000028E081C7919)&gt;</span>
0000028E000C3024   <span class="token number">104</span>  443bc9         cmpl <span class="token register variable">r9</span>,<span class="token register variable">rcx</span>
0000028E000C3027   <span class="token number">107</span>  0f85e2000000   jnz 0000028E000C310F  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x1ef</span><span class="token operator">&gt;</span>
0000028E000C302D   <span class="token number">10d</span>  b9493f2408     movl <span class="token register variable">rcx</span>,0000000008243F49    <span class="token comment">;; (compressed) object: 0x028e08243f49 &lt;JSFunction log (sfi = 0000028E081C7639)&gt;</span>
0000028E000C3032   <span class="token number">112</span>  3bcf           cmpl <span class="token register variable">rcx</span>,<span class="token register variable">rdi</span>
0000028E000C3034   <span class="token number">114</span>  0f85e1000000   jnz 0000028E000C311B  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x1fb</span><span class="token operator">&gt;</span>
0000028E000C303A   11a  b9bd3e2408     movl <span class="token register variable">rcx</span>,0000000008243EBD    <span class="token comment">;; (compressed) object: 0x028e08243ebd &lt;JSFunction exp (sfi = 0000028E081C7571)&gt;</span>
0000028E000C303F   11f  413bc8         cmpl <span class="token register variable">rcx</span>,<span class="token register variable">r8</span>
0000028E000C3042   <span class="token number">122</span>  0f85df000000   jnz 0000028E000C3127  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x207</span><span class="token operator">&gt;</span>
0000028E000C3048   <span class="token number">128</span>  488bca         REX.W movq <span class="token register variable">rcx</span>,<span class="token register variable">rdx</span>
0000028E000C304B   12b  d1f9           sarl <span class="token register variable">rcx</span>, <span class="token number">1</span>
0000028E000C304D   <span class="token number">12d</span>  83c101         addl <span class="token register variable">rcx</span>,<span class="token number">0x1</span>
0000028E000C3050   <span class="token number">130</span>  0f80dd000000   jo 0000028E000C3133  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x213</span><span class="token operator">&gt;</span>
0000028E000C3056   <span class="token number">136</span>  493b6560       REX.W cmpq <span class="token register variable">rsp</span>,<span class="token operator">[</span><span class="token register variable">r13</span><span class="token operator">+</span><span class="token number">0x60</span><span class="token operator">]</span> (<span class="token keyword">external value (StackGuard::address_of_jslimit()))</span>
0000028E000C305A   13a  0f8713000000   ja 0000028E000C3073  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x153</span><span class="token operator">&gt;</span>
0000028E000C3060   <span class="token number">140</span>  e940000000     jmp 0000028E000C30A5  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x185</span><span class="token operator">&gt;</span>
0000028E000C3065   <span class="token number">145</span>  660f1f840000000000 nop
0000028E000C306E   14e  <span class="token number">6690</span>           nop
0000028E000C3070   <span class="token number">150</span>  488bca         REX.W movq <span class="token register variable">rcx</span>,<span class="token register variable">rdx</span>
0000028E000C3073   <span class="token number">153</span>  81f980969800   cmpl <span class="token register variable">rcx</span>,<span class="token number">0x989680</span>
0000028E000C3079   <span class="token number">159</span>  0f8d17000000   jge 0000028E000C3096  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x176</span><span class="token operator">&gt;</span>
0000028E000C307F   15f  488bd1         REX.W movq <span class="token register variable">rdx</span>,<span class="token register variable">rcx</span>
0000028E000C3082   <span class="token number">162</span>  83c201         addl <span class="token register variable">rdx</span>,<span class="token number">0x1</span>
0000028E000C3085   <span class="token number">165</span>  0f80b4000000   jo 0000028E000C313F  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x21f</span><span class="token operator">&gt;</span>
0000028E000C308B   16b  493b6560       REX.W cmpq <span class="token register variable">rsp</span>,<span class="token operator">[</span><span class="token register variable">r13</span><span class="token operator">+</span><span class="token number">0x60</span><span class="token operator">]</span> (<span class="token keyword">external value (StackGuard::address_of_jslimit()))</span>
0000028E000C308F   16f  77df           ja 0000028E000C3070  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x150</span><span class="token operator">&gt;</span>
0000028E000C3091   <span class="token number">171</span>  e942000000     jmp 0000028E000C30D8  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x1b8</span><span class="token operator">&gt;</span>
0000028E000C3096   <span class="token number">176</span>  48b80008000000000000 REX.W movq <span class="token register variable">rax</span>,<span class="token number">0000000000000800</span>
0000028E000C30A0   <span class="token number">180</span>  e9f8feffff     jmp 0000028E000C2F9D  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x7d</span><span class="token operator">&gt;</span>
0000028E000C30A5   <span class="token number">185</span>  48894da8       REX.W movq <span class="token operator">[</span><span class="token register variable">rbp</span><span class="token operator">-</span><span class="token number">0x58</span><span class="token operator">]</span>,<span class="token register variable">rcx</span>
0000028E000C30A9   <span class="token number">189</span>  33c0           xorl <span class="token register variable">rax</span>,<span class="token register variable">rax</span>
0000028E000C30AB   18b  48bea10d24088e020000 REX.W movq <span class="token register variable">rsi</span>,0000028E08240DA1    <span class="token comment">;; object: 0x028e08240da1 &lt;NativeContext[247]&gt;</span>
0000028E000C30B5   <span class="token number">195</span>  48bbd0ec24cffb7f0000 REX.W movq <span class="token register variable">rbx</span>,00007FFBCF24ECD0    <span class="token comment">;; external reference (Runtime::StackGuard)</span>
0000028E000C30BF   19f  488bd0         REX.W movq <span class="token register variable">rdx</span>,<span class="token register variable">rax</span>
0000028E000C30C2   1a2  488bfe         REX.W movq <span class="token register variable">rdi</span>,<span class="token register variable">rsi</span>
0000028E000C30C5   1a5  49ba00a8edcdfb7f0000 REX.W movq <span class="token register variable">r10</span>,00007FFBCDEDA800  (CEntry_Return1_DontSaveFPRegs_ArgvOnStack_NoBuiltinExit)    <span class="token comment">;; off heap target</span>
0000028E000C30CF   1af  41ffd2         call <span class="token register variable">r10</span>
0000028E000C30D2   1b2  488b4da8       REX.W movq <span class="token register variable">rcx</span>,<span class="token operator">[</span><span class="token register variable">rbp</span><span class="token operator">-</span><span class="token number">0x58</span><span class="token operator">]</span>
0000028E000C30D6   1b6  eb9b           jmp 0000028E000C3073  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x153</span><span class="token operator">&gt;</span>
0000028E000C30D8   1b8  488955a8       REX.W movq <span class="token operator">[</span><span class="token register variable">rbp</span><span class="token operator">-</span><span class="token number">0x58</span><span class="token operator">]</span>,<span class="token register variable">rdx</span>
0000028E000C30DC   1bc  488b1dd4ffffff REX.W movq <span class="token register variable">rbx</span>,<span class="token operator">[</span>rip<span class="token operator">+</span><span class="token number">0xffffffd4</span><span class="token operator">]</span>
0000028E000C30E3   1c3  33c0           xorl <span class="token register variable">rax</span>,<span class="token register variable">rax</span>
0000028E000C30E5   1c5  48bea10d24088e020000 REX.W movq <span class="token register variable">rsi</span>,0000028E08240DA1    <span class="token comment">;; object: 0x028e08240da1 &lt;NativeContext[247]&gt;</span>
0000028E000C30EF   1cf  4c8b15d1ffffff REX.W movq <span class="token register variable">r10</span>,<span class="token operator">[</span>rip<span class="token operator">+</span><span class="token number">0xffffffd1</span><span class="token operator">]</span>
0000028E000C30F6   1d6  41ffd2         call <span class="token register variable">r10</span>
0000028E000C30F9   1d9  488b55a8       REX.W movq <span class="token register variable">rdx</span>,<span class="token operator">[</span><span class="token register variable">rbp</span><span class="token operator">-</span><span class="token number">0x58</span><span class="token operator">]</span>
0000028E000C30FD   1dd  e96effffff     jmp 0000028E000C3070  <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0x150</span><span class="token operator">&gt;</span>
0000028E000C3102   <span class="token number">1e2</span>  <span class="token number">90</span>             nop
0000028E000C3103   <span class="token number">1e3</span>  49c7c500000000 REX.W movq <span class="token register variable">r13</span>,<span class="token number">0x0</span>
0000028E000C310A   1ea  e831ef0300     call <span class="token number">0000028E00102040</span>    <span class="token comment">;; eager deoptimization bailout</span>
0000028E000C310F   1ef  49c7c501000000 REX.W movq <span class="token register variable">r13</span>,<span class="token number">0x1</span>
0000028E000C3116   1f6  e825ef0300     call <span class="token number">0000028E00102040</span>    <span class="token comment">;; eager deoptimization bailout</span>
0000028E000C311B   1fb  49c7c502000000 REX.W movq <span class="token register variable">r13</span>,<span class="token number">0x2</span>
0000028E000C3122   <span class="token number">202</span>  e819ef0300     call <span class="token number">0000028E00102040</span>    <span class="token comment">;; eager deoptimization bailout</span>
0000028E000C3127   <span class="token number">207</span>  49c7c503000000 REX.W movq <span class="token register variable">r13</span>,<span class="token number">0x3</span>
0000028E000C312E   20e  e80def0300     call <span class="token number">0000028E00102040</span>    <span class="token comment">;; eager deoptimization bailout</span>
0000028E000C3133   <span class="token number">213</span>  49c7c504000000 REX.W movq <span class="token register variable">r13</span>,<span class="token number">0x4</span>
0000028E000C313A   21a  e801ef0300     call <span class="token number">0000028E00102040</span>    <span class="token comment">;; eager deoptimization bailout</span>
0000028E000C313F   21f  49c7c505000000 REX.W movq <span class="token register variable">r13</span>,<span class="token number">0x5</span>
0000028E000C3146   <span class="token number">226</span>  e8f5ee0300     call <span class="token number">0000028E00102040</span>    <span class="token comment">;; eager deoptimization bailout</span>
0000028E000C314B   22b  49c7c506000000 REX.W movq <span class="token register variable">r13</span>,<span class="token number">0x6</span>
0000028E000C3152   <span class="token number">232</span>  e8e9ee0700     call <span class="token number">0000028E00142040</span>    <span class="token comment">;; lazy deoptimization bailout</span>
0000028E000C3157   <span class="token number">237</span>  49c7c507000000 REX.W movq <span class="token register variable">r13</span>,<span class="token number">0x7</span>
0000028E000C315E   23e  e8ddee0700     call <span class="token number">0000028E00142040</span>    <span class="token comment">;; lazy deoptimization bailout</span>
0000028E000C3163   <span class="token number">243</span>  <span class="token number">90</span>             nop
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新于:</span> <span class="time">5/29/2020, 10:55:31 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blogs/2020-05/ESLint + TypeScript配置全局变量.html" class="prev">
        ESLint + TypeScript配置全局变量
      </a></span> <span class="next"><a href="/blogs/2020-05/Ubuntu 18.04升级systemctl（systemd）到v245.html">
        Ubuntu 18.04升级systemctl（systemd）到v245
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.45eeab25.js" defer></script><script src="/assets/js/2.fca48e13.js" defer></script><script src="/assets/js/21.0b1f777a.js" defer></script>
  </body>
</html>
